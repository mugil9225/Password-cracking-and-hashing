<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project 7 ‚Äî Password Cracking & Hashing Lab</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap');

  :root {
    --bg: #060a0f;
    --panel: #0b1118;
    --border: #0f3d2e;
    --green: #00ff88;
    --green-dim: #00c966;
    --green-dark: #003d20;
    --red: #ff3b5c;
    --amber: #ffaa00;
    --blue: #00aaff;
    --text: #c8e8d0;
    --muted: #4a7a5a;
    --grid: rgba(0,255,136,0.03);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Exo 2', sans-serif;
    min-height: 100vh;
    background-image:
      repeating-linear-gradient(0deg, transparent, transparent 40px, var(--grid) 40px, var(--grid) 41px),
      repeating-linear-gradient(90deg, transparent, transparent 40px, var(--grid) 40px, var(--grid) 41px);
  }

  /* HEADER */
  header {
    background: linear-gradient(135deg, #060a0f 0%, #0b1f15 50%, #060a0f 100%);
    border-bottom: 2px solid var(--green);
    padding: 24px 40px;
    display: flex; align-items: center; gap: 20px;
    position: relative; overflow: hidden;
  }
  header::before {
    content: '';
    position: absolute; inset: 0;
    background: radial-gradient(ellipse 60% 100% at 50% -20%, rgba(0,255,136,0.08), transparent);
  }
  .logo-badge {
    width: 54px; height: 54px;
    border: 2px solid var(--green);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 26px;
    background: var(--green-dark);
    box-shadow: 0 0 20px rgba(0,255,136,0.3);
    flex-shrink: 0;
  }
  .header-text h1 {
    font-family: 'Orbitron', monospace;
    font-size: 1.3rem; font-weight: 900;
    color: var(--green);
    letter-spacing: 3px;
    text-shadow: 0 0 20px rgba(0,255,136,0.5);
  }
  .header-text p {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.78rem; color: var(--muted);
    letter-spacing: 2px; margin-top: 4px;
  }
  .warning-badge {
    margin-left: auto;
    background: rgba(255,170,0,0.1);
    border: 1px solid var(--amber);
    border-radius: 6px;
    padding: 6px 14px;
    font-size: 0.72rem;
    color: var(--amber);
    font-family: 'Share Tech Mono', monospace;
    letter-spacing: 1px;
    text-align: center;
  }

  /* NAV TABS */
  nav {
    display: flex; gap: 2px;
    background: var(--panel);
    border-bottom: 1px solid var(--border);
    padding: 0 40px;
    overflow-x: auto;
  }
  .tab {
    padding: 14px 22px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.8rem;
    color: var(--muted);
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    white-space: nowrap;
    letter-spacing: 1px;
  }
  .tab:hover { color: var(--text); }
  .tab.active { color: var(--green); border-bottom-color: var(--green); }

  /* MAIN */
  main { padding: 30px 40px; max-width: 1100px; margin: 0 auto; }

  .section { display: none; }
  .section.active { display: block; }

  /* PANEL CARD */
  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }
  .card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, var(--green), transparent);
  }
  .card h2 {
    font-family: 'Orbitron', monospace;
    font-size: 0.9rem;
    color: var(--green);
    letter-spacing: 2px;
    margin-bottom: 18px;
    display: flex; align-items: center; gap: 10px;
  }
  .card h2 span.tag {
    font-size: 0.65rem;
    background: var(--green-dark);
    border: 1px solid var(--green);
    padding: 2px 8px;
    border-radius: 4px;
    letter-spacing: 1px;
  }

  /* INPUT */
  .input-row { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; }
  input[type="text"], input[type="password"], select {
    background: #080e14;
    border: 1px solid var(--border);
    color: var(--green);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.88rem;
    padding: 10px 16px;
    border-radius: 8px;
    outline: none;
    transition: border-color 0.2s;
    flex: 1; min-width: 180px;
  }
  input:focus, select:focus { border-color: var(--green); box-shadow: 0 0 10px rgba(0,255,136,0.1); }

  .btn {
    background: var(--green-dark);
    border: 1px solid var(--green);
    color: var(--green);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.82rem;
    padding: 10px 22px;
    border-radius: 8px;
    cursor: pointer;
    letter-spacing: 1px;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .btn:hover { background: rgba(0,255,136,0.15); box-shadow: 0 0 15px rgba(0,255,136,0.2); }
  .btn.danger { border-color: var(--red); color: var(--red); background: rgba(255,59,92,0.08); }

  /* OUTPUT TERMINAL */
  .terminal {
    background: #040608;
    border: 1px solid #1a2a1a;
    border-radius: 8px;
    padding: 18px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.82rem;
    line-height: 1.7;
    min-height: 100px;
    max-height: 360px;
    overflow-y: auto;
    color: #7aba8a;
  }
  .terminal .ok    { color: var(--green); }
  .terminal .fail  { color: var(--red); }
  .terminal .warn  { color: var(--amber); }
  .terminal .info  { color: var(--blue); }
  .terminal .dim   { color: var(--muted); }

  /* HASH COMPARISON GRID */
  .hash-grid { display: grid; gap: 10px; }
  .hash-item {
    background: #040608;
    border: 1px solid #1a2a1a;
    border-radius: 8px;
    padding: 12px 16px;
    display: grid;
    grid-template-columns: 100px 1fr;
    gap: 8px; align-items: center;
  }
  .hash-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.75rem;
    color: var(--muted);
  }
  .hash-value {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.78rem;
    color: var(--green);
    word-break: break-all;
  }

  /* STRENGTH METER */
  .strength-bar-wrap {
    background: #040608;
    border-radius: 6px;
    height: 10px;
    overflow: hidden;
    margin: 10px 0;
  }
  .strength-bar {
    height: 100%;
    border-radius: 6px;
    transition: width 0.5s ease, background 0.3s;
    width: 0%;
  }

  .checks-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; margin: 12px 0; }
  .check-item {
    background: #040608;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 0.76rem;
    font-family: 'Share Tech Mono', monospace;
    display: flex; gap: 8px; align-items: center;
  }
  .check-item.pass { border: 1px solid #1a3a1a; color: var(--green); }
  .check-item.fail { border: 1px solid #3a1a1a; color: var(--red); }

  /* CRACKER SIM */
  .crack-status {
    display: flex; flex-wrap: wrap; gap: 16px;
    margin-bottom: 16px;
  }
  .stat-box {
    background: #040608;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 18px;
    text-align: center;
    min-width: 130px;
  }
  .stat-box .num {
    font-family: 'Orbitron', monospace;
    font-size: 1.3rem;
    color: var(--green);
    display: block;
  }
  .stat-box .lbl {
    font-size: 0.65rem;
    color: var(--muted);
    font-family: 'Share Tech Mono', monospace;
    letter-spacing: 1px;
    margin-top: 4px;
    display: block;
  }

  /* SALTING VIZ */
  .salt-row {
    display: grid;
    grid-template-columns: 80px 140px 1fr;
    gap: 12px;
    align-items: center;
    padding: 10px 14px;
    background: #040608;
    border: 1px solid #1a2a1a;
    border-radius: 8px;
    margin-bottom: 8px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.76rem;
  }
  .salt-row .user { color: var(--blue); }
  .salt-row .salt { color: var(--amber); }
  .salt-row .hash { color: var(--green); word-break: break-all; }

  /* ALGO COMPARISON TABLE */
  table { width: 100%; border-collapse: collapse; }
  th, td {
    padding: 10px 16px;
    text-align: left;
    border-bottom: 1px solid #1a2a1a;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.78rem;
  }
  th { color: var(--green); font-weight: normal; letter-spacing: 1px; }
  td { color: var(--text); }
  tr:last-child td { border-bottom: none; }
  .badge-good { color: var(--green); }
  .badge-warn { color: var(--amber); }
  .badge-bad  { color: var(--red); }

  /* RAINBOW TABLE VIZ */
  .db-row {
    display: flex; align-items: center; gap: 12px;
    padding: 8px 14px;
    background: #040608;
    border: 1px solid #1a2a1a;
    border-radius: 6px;
    margin-bottom: 6px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.75rem;
    transition: border-color 0.3s, background 0.3s;
  }
  .db-row.cracked { border-color: var(--red); background: rgba(255,59,92,0.05); }
  .db-row.safe    { border-color: var(--green); background: rgba(0,255,136,0.03); }
  .db-row .user   { width: 70px; color: var(--blue); }
  .db-row .hash   { flex:1; color: var(--muted); word-break: break-all; }
  .db-row .result { width: 130px; text-align: right; }

  /* PROGRESS */
  .progress-wrap { height: 6px; background: #1a2a1a; border-radius: 3px; margin: 8px 0; }
  .progress-bar  { height: 100%; border-radius: 3px; background: var(--green); transition: width 0.1s linear; }

  /* SCROLLBAR */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: #040608; }
  ::-webkit-scrollbar-thumb { background: var(--green-dark); border-radius: 3px; }

  .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  @media (max-width: 700px) { .two-col { grid-template-columns: 1fr; } main { padding: 16px; } nav { padding: 0 16px; } header { padding: 16px; } }
</style>
</head>
<body>

<header>
  <div class="logo-badge">üîê</div>
  <div class="header-text">
    <h1>PROJECT 7 ‚Äî PASSWORD SECURITY LAB</h1>
    <p>HASHING ALGORITHMS ¬∑ SALTING ¬∑ PASSWORD CRACKING TECHNIQUES</p>
  </div>
  <div class="warning-badge">‚ö† EDUCATIONAL<br>USE ONLY</div>
</header>

<nav>
  <div class="tab active" onclick="showTab('hashing')">01_HASHING</div>
  <div class="tab" onclick="showTab('salting')">02_SALTING</div>
  <div class="tab" onclick="showTab('strength')">03_STRENGTH</div>
  <div class="tab" onclick="showTab('cracker')">04_CRACKER_SIM</div>
  <div class="tab" onclick="showTab('rainbow')">05_RAINBOW_TABLE</div>
  <div class="tab" onclick="showTab('reference')">06_TOOLS_REF</div>
</nav>

<main>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 1: HASHING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-hashing" class="section active">
  <div class="card">
    <h2>üîí HASH FUNCTION EXPLORER <span class="tag">ALGORITHMS</span></h2>
    <div class="input-row">
      <input type="text" id="hash-input" placeholder="Type any text to hash..." value="password123">
      <button class="btn" onclick="computeHashes()">COMPUTE HASHES</button>
    </div>
    <div class="hash-grid" id="hash-output"></div>
  </div>

  <div class="card">
    <h2>‚ö° AVALANCHE EFFECT DEMO</h2>
    <p style="font-size:0.82rem; color:var(--muted); margin-bottom:14px;">A single character change produces a completely different hash ‚Äî this is by design.</p>
    <div class="input-row">
      <input type="text" id="aval-a" placeholder="String A" value="hello">
      <input type="text" id="aval-b" placeholder="String B (change 1 char)" value="hellO">
      <button class="btn" onclick="avalanche()">COMPARE</button>
    </div>
    <div id="aval-output" class="terminal"></div>
  </div>

  <div class="card">
    <h2>üìä ALGORITHM COMPARISON TABLE</h2>
    <table>
      <tr><th>Algorithm</th><th>Output Size</th><th>Speed</th><th>Collisions</th><th>Password Use</th><th>Best For</th></tr>
      <tr><td>MD5</td><td>128-bit</td><td class="badge-warn">Very Fast</td><td class="badge-bad">Broken</td><td class="badge-bad">‚ùå Never</td><td>File checksums (legacy)</td></tr>
      <tr><td>SHA-1</td><td>160-bit</td><td class="badge-warn">Fast</td><td class="badge-bad">Broken</td><td class="badge-bad">‚ùå Never</td><td>Git commits (legacy)</td></tr>
      <tr><td>SHA-256</td><td>256-bit</td><td class="badge-warn">Fast</td><td class="badge-good">None known</td><td class="badge-bad">‚ùå Avoid</td><td>File integrity, TLS, Bitcoin</td></tr>
      <tr><td>SHA-512</td><td>512-bit</td><td class="badge-warn">Fast</td><td class="badge-good">None known</td><td class="badge-bad">‚ùå Avoid</td><td>High-sec file integrity</td></tr>
      <tr><td>bcrypt</td><td>184-bit + meta</td><td class="badge-good">Tunable slow</td><td class="badge-good">N/A</td><td class="badge-good">‚úÖ Good</td><td>Password storage</td></tr>
      <tr><td>scrypt</td><td>Variable</td><td class="badge-good">Tunable slow</td><td class="badge-good">N/A</td><td class="badge-good">‚úÖ Good</td><td>Passwords, key derivation</td></tr>
      <tr><td>Argon2id</td><td>Variable</td><td class="badge-good">Tunable slow</td><td class="badge-good">N/A</td><td class="badge-good">‚úÖ Best</td><td>Password storage (PHC winner)</td></tr>
    </table>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 2: SALTING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-salting" class="section">
  <div class="card">
    <h2>üßÇ SALTING DEMONSTRATION</h2>
    <p style="font-size:0.82rem; color:var(--muted); margin-bottom:16px;">
      A <strong style="color:var(--amber)">salt</strong> is a random value added to each password before hashing. 
      Even identical passwords produce different hashes, defeating rainbow table and lookup attacks.
    </p>
    <div class="input-row">
      <input type="text" id="salt-pw" placeholder="Enter password to hash with salts" value="password123">
      <button class="btn" onclick="demoSalting()">GENERATE SALTED HASHES</button>
    </div>
    <div id="salt-output"></div>
  </div>

  <div class="two-col">
    <div class="card">
      <h2>‚ùå WITHOUT SALT</h2>
      <div class="terminal" id="no-salt-term" style="min-height:140px;"></div>
    </div>
    <div class="card">
      <h2>‚úÖ WITH SALT</h2>
      <div class="terminal" id="with-salt-term" style="min-height:140px;"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 3: STRENGTH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-strength" class="section">
  <div class="card">
    <h2>üí™ PASSWORD STRENGTH ANALYZER</h2>
    <div class="input-row">
      <input type="text" id="pw-analyze" placeholder="Enter a password to analyze..." value="P@ssw0rd">
      <button class="btn" onclick="analyzeStrength()">ANALYZE</button>
    </div>

    <div style="margin:10px 0;">
      <div style="display:flex; justify-content:space-between; font-size:0.75rem; font-family:'Share Tech Mono',monospace; margin-bottom:4px;">
        <span id="strength-label" style="color:var(--muted)">‚Äî</span>
        <span id="strength-score" style="color:var(--muted)">‚Äî</span>
      </div>
      <div class="strength-bar-wrap"><div class="strength-bar" id="strength-bar"></div></div>
    </div>

    <div class="checks-grid" id="pw-checks"></div>

    <div id="pw-stats" class="terminal" style="margin-top:12px;"></div>
  </div>

  <div class="card">
    <h2>‚è± CRACK TIME ESTIMATOR (GPU Brute-Force)</h2>
    <p style="font-size:0.78rem; color:var(--muted); margin-bottom:14px;">Estimated time at 8 billion hashes/second (modern GPU attacking MD5 ‚Äî bcrypt/Argon2 is 10,000,000√ó harder)</p>
    <table id="crack-table">
      <tr><th>Pattern</th><th>Example</th><th>Search Space</th><th>Est. Crack Time</th></tr>
    </table>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 4: CRACKER SIM ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-cracker" class="section">
  <div class="card">
    <h2>‚öî DICTIONARY ATTACK SIMULATOR <span class="tag">EDUCATIONAL</span></h2>
    <p style="font-size:0.78rem; color:var(--muted); margin-bottom:14px;">
      Set a target password (from the wordlist). The simulator will "crack" it using a dictionary attack, 
      showing how quickly common passwords are compromised.
    </p>

    <div class="input-row">
      <select id="crack-target">
        <option value="password">password</option>
        <option value="123456">123456</option>
        <option value="qwerty">qwerty</option>
        <option value="iloveyou">iloveyou</option>
        <option value="letmein">letmein</option>
        <option value="dragon">dragon</option>
        <option value="master">master</option>
        <option value="sunshine">sunshine</option>
      </select>
      <button class="btn" onclick="startCrack()" id="crack-btn">‚ñ∂ START ATTACK</button>
      <button class="btn danger" onclick="stopCrack()" id="stop-btn" style="display:none">‚ñ† STOP</button>
    </div>

    <div class="crack-status">
      <div class="stat-box"><span class="num" id="stat-attempts">0</span><span class="lbl">ATTEMPTS</span></div>
      <div class="stat-box"><span class="num" id="stat-time">0.000</span><span class="lbl">SECONDS</span></div>
      <div class="stat-box"><span class="num" id="stat-rate">0</span><span class="lbl">HASHES/SEC</span></div>
      <div class="stat-box"><span class="num" id="stat-status">READY</span><span class="lbl">STATUS</span></div>
    </div>

    <div class="progress-wrap"><div class="progress-bar" id="crack-progress"></div></div>
    <div class="terminal" id="crack-log"></div>
  </div>

  <div class="card">
    <h2>üîÑ HYBRID ATTACK (WORDLIST + MUTATIONS)</h2>
    <p style="font-size:0.78rem; color:var(--muted); margin-bottom:14px;">
      Rules applied to each word: capitalize, leet-speak, append numbers/symbols.
    </p>
    <div class="input-row">
      <input type="text" id="hybrid-target" placeholder="Target password (e.g. Password1!)" value="Password123">
      <button class="btn" onclick="runHybrid()">RUN HYBRID ATTACK</button>
    </div>
    <div class="terminal" id="hybrid-log"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 5: RAINBOW TABLE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-rainbow" class="section">
  <div class="card">
    <h2>üåà RAINBOW TABLE ATTACK VISUALIZATION</h2>
    <p style="font-size:0.78rem; color:var(--muted); margin-bottom:14px;">
      Without salts, an attacker with a pre-computed hash‚Üípassword table can crack ALL matching accounts instantly.
    </p>
    <button class="btn" onclick="runRainbowAttack()">üö® SIMULATE ATTACK (UNSALTED DB)</button>
    <button class="btn" style="margin-left:8px;" onclick="runSaltedAttack()">üõ° SIMULATE ATTACK (SALTED DB)</button>
    <div style="margin-top:16px;" id="rainbow-db"></div>
    <div class="terminal" id="rainbow-log" style="margin-top:12px;"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SECTION 6: TOOLS REFERENCE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="sec-reference" class="section">
  <div class="two-col">
    <div class="card">
      <h2>‚ö° HASHCAT REFERENCE</h2>
      <div class="terminal" style="max-height:none;">
<span class="info"># Identify hash type</span>
hashcat --identify hash.txt

<span class="info"># Dictionary attack (-a 0)</span>
hashcat -a 0 -m 0 hashes.txt rockyou.txt

<span class="info"># Brute-force attack (-a 3)</span>
hashcat -a 3 -m 0 hashes.txt <span class="ok">?a?a?a?a?a?a</span>

<span class="info"># Hybrid: word + 3 digits (-a 6)</span>
hashcat -a 6 -m 0 hashes.txt words.txt <span class="ok">?d?d?d</span>

<span class="info"># Rule-based attack</span>
hashcat -a 0 -r rules/best64.rule hashes.txt words.txt

<span class="dim">‚îÄ‚îÄ‚îÄ Hash Mode (-m) Reference ‚îÄ‚îÄ‚îÄ</span>
<span class="ok">0</span>     MD5
<span class="ok">100</span>   SHA-1
<span class="ok">1400</span>  SHA-256
<span class="ok">1700</span>  SHA-512
<span class="ok">1800</span>  sha512crypt (/etc/shadow)
<span class="ok">3200</span>  bcrypt $2*$
<span class="ok">5600</span>  NetNTLMv2
<span class="ok">13100</span> Kerberos 5 TGS-REP

<span class="dim">‚îÄ‚îÄ‚îÄ Charset Masks ‚îÄ‚îÄ‚îÄ</span>
<span class="ok">?l</span> lowercase  <span class="ok">?u</span> uppercase
<span class="ok">?d</span> digits     <span class="ok">?s</span> special
<span class="ok">?a</span> all printable
      </div>
    </div>

    <div class="card">
      <h2>üî® JOHN THE RIPPER REFERENCE</h2>
      <div class="terminal" style="max-height:none;">
<span class="info"># Auto-detect and crack</span>
john --wordlist=rockyou.txt hashes.txt

<span class="info"># Show cracked passwords</span>
john --show hashes.txt

<span class="info"># Crack Linux shadow file</span>
unshadow /etc/passwd /etc/shadow > combined.txt
john --wordlist=rockyou.txt combined.txt

<span class="info"># Rule-based attack</span>
john --wordlist=rockyou.txt <span class="ok">--rules=Jumbo</span> hashes.txt

<span class="info"># Specify format</span>
john --format=raw-md5 --wordlist=rockyou.txt hashes.txt

<span class="info"># List all formats</span>
john --list=formats | grep -i bcrypt

<span class="dim">‚îÄ‚îÄ‚îÄ Common Formats ‚îÄ‚îÄ‚îÄ</span>
<span class="ok">raw-md5</span>     raw-sha1    raw-sha256
<span class="ok">bcrypt</span>      sha512crypt  nt
<span class="ok">md5crypt</span>    krb5tgs     zip

<span class="dim">‚îÄ‚îÄ‚îÄ Wordlists ‚îÄ‚îÄ‚îÄ</span>
rockyou.txt      (14M passwords)
SecLists         (1B+ entries)
CrackStation     (1.4B entries)
      </div>
    </div>
  </div>

  <div class="card">
    <h2>üõ° DEFENSE CHECKLIST</h2>
    <div class="checks-grid">
      <div class="check-item pass">‚úÖ Use bcrypt / Argon2id</div>
      <div class="check-item pass">‚úÖ Unique random salt per user</div>
      <div class="check-item pass">‚úÖ Cost factor ‚â• 12 (bcrypt)</div>
      <div class="check-item pass">‚úÖ Enforce MFA</div>
      <div class="check-item pass">‚úÖ Rate-limit login attempts</div>
      <div class="check-item pass">‚úÖ Check against HaveIBeenPwned</div>
      <div class="check-item pass">‚úÖ Minimum 12 character policy</div>
      <div class="check-item pass">‚úÖ Secure password reset flow</div>
      <div class="check-item fail">‚ùå Never use MD5/SHA-1 for passwords</div>
      <div class="check-item fail">‚ùå Never store plaintext passwords</div>
      <div class="check-item fail">‚ùå Never reuse salts</div>
      <div class="check-item fail">‚ùå Never roll your own crypto</div>
    </div>
  </div>
</div>

</main>

<script>
// ‚îÄ‚îÄ‚îÄ TAB SWITCHING ‚îÄ‚îÄ‚îÄ
function showTab(name) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('sec-' + name).classList.add('active');
}

// ‚îÄ‚îÄ‚îÄ SIMPLE HASH (FNV-1a for browser, educational) ‚îÄ‚îÄ‚îÄ
// Real crypto hashing uses SubtleCrypto
async function sha256(str) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
}
async function sha512(str) {
  const buf = await crypto.subtle.digest('SHA-512', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
}
async function sha1(str) {
  const buf = await crypto.subtle.digest('SHA-1', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
}
function md5(str) {
  // Minimal MD5 implementation for educational display
  function safeAdd(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}
  function bitRotateLeft(num,cnt){return(num<<cnt)|(num>>>(32-cnt))}
  function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}
  function md5ff(a,b,c,d,x,s,t){return md5cmn((b&c)|((~b)&d),a,b,x,s,t)}
  function md5gg(a,b,c,d,x,s,t){return md5cmn((b&d)|(c&(~d)),a,b,x,s,t)}
  function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}
  function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|(~d)),a,b,x,s,t)}
  function usingUTF8(s){return unescape(encodeURIComponent(s))}
  function str2rstr_utf8(inp){return usingUTF8(inp)}
  function rstr2binl(inp){var o=[];o[(inp.length>>2)-1]=undefined;for(var i=0;i<o.length;i+=1){o[i]=0}var mask=0xFF;for(var i=0;i<inp.length*8;i+=8){o[i>>5]|=(inp.charCodeAt(i/8)&mask)<<(i%32)}return o}
  function binl2rstr(inp){var o='';for(var i=0;i<inp.length*32;i+=8){o+=String.fromCharCode((inp[i>>5]>>>(i%32))&0xFF)}return o}
  function binlMD5(x,len){x[len>>5]|=0x80<<(len%32);x[(((len+64)>>>9)<<4)+14]=len;var i,olda,oldb,oldc,oldd,a=1732584193,b=-271733879,c=-1732584194,d=271733878;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=md5ff(a,b,c,d,x[i],7,-680876936);d=md5ff(d,a,b,c,x[i+1],12,-389564586);c=md5ff(c,d,a,b,x[i+2],17,606105819);b=md5ff(b,c,d,a,x[i+3],22,-1044525330);a=md5ff(a,b,c,d,x[i+4],7,-176418897);d=md5ff(d,a,b,c,x[i+5],12,1200080426);c=md5ff(c,d,a,b,x[i+6],17,-1473231341);b=md5ff(b,c,d,a,x[i+7],22,-45705983);a=md5ff(a,b,c,d,x[i+8],7,1770035416);d=md5ff(d,a,b,c,x[i+9],12,-1958414417);c=md5ff(c,d,a,b,x[i+10],17,-42063);b=md5ff(b,c,d,a,x[i+11],22,-1990404162);a=md5ff(a,b,c,d,x[i+12],7,1804603682);d=md5ff(d,a,b,c,x[i+13],12,-40341101);c=md5ff(c,d,a,b,x[i+14],17,-1502002290);b=md5ff(b,c,d,a,x[i+15],22,1236535329);a=md5gg(a,b,c,d,x[i+1],5,-165796510);d=md5gg(d,a,b,c,x[i+6],9,-1069501632);c=md5gg(c,d,a,b,x[i+11],14,643717713);b=md5gg(b,c,d,a,x[i],20,-373897302);a=md5gg(a,b,c,d,x[i+5],5,-701558691);d=md5gg(d,a,b,c,x[i+10],9,38016083);c=md5gg(c,d,a,b,x[i+15],14,-660478335);b=md5gg(b,c,d,a,x[i+4],20,-405537848);a=md5gg(a,b,c,d,x[i+9],5,568446438);d=md5gg(d,a,b,c,x[i+14],9,-1019803690);c=md5gg(c,d,a,b,x[i+3],14,-187363961);b=md5gg(b,c,d,a,x[i+8],20,1163531501);a=md5gg(a,b,c,d,x[i+13],5,-1444681467);d=md5gg(d,a,b,c,x[i+2],9,-51403784);c=md5gg(c,d,a,b,x[i+7],14,1735328473);b=md5gg(b,c,d,a,x[i+12],20,-1926607734);a=md5hh(a,b,c,d,x[i+5],4,-378558);d=md5hh(d,a,b,c,x[i+8],11,-2022574463);c=md5hh(c,d,a,b,x[i+11],16,1839030562);b=md5hh(b,c,d,a,x[i+14],23,-35309556);a=md5hh(a,b,c,d,x[i+1],4,-1530992060);d=md5hh(d,a,b,c,x[i+4],11,1272893353);c=md5hh(c,d,a,b,x[i+7],16,-155497632);b=md5hh(b,c,d,a,x[i+10],23,-1094730640);a=md5hh(a,b,c,d,x[i+13],4,681279174);d=md5hh(d,a,b,c,x[i],11,-358537222);c=md5hh(c,d,a,b,x[i+3],16,-722521979);b=md5hh(b,c,d,a,x[i+6],23,76029189);a=md5hh(a,b,c,d,x[i+9],4,-640364487);d=md5hh(d,a,b,c,x[i+12],11,-421815835);c=md5hh(c,d,a,b,x[i+15],16,530742520);b=md5hh(b,c,d,a,x[i+2],23,-995338651);a=md5ii(a,b,c,d,x[i],6,-198630844);d=md5ii(d,a,b,c,x[i+7],10,1126891415);c=md5ii(c,d,a,b,x[i+14],15,-1416354905);b=md5ii(b,c,d,a,x[i+5],21,-57434055);a=md5ii(a,b,c,d,x[i+12],6,1700485571);d=md5ii(d,a,b,c,x[i+3],10,-1894986606);c=md5ii(c,d,a,b,x[i+10],15,-1051523);b=md5ii(b,c,d,a,x[i+1],21,-2054922799);a=md5ii(a,b,c,d,x[i+8],6,1873313359);d=md5ii(d,a,b,c,x[i+15],10,-30611744);c=md5ii(c,d,a,b,x[i+6],15,-1560198380);b=md5ii(b,c,d,a,x[i+13],21,1309151649);a=md5ii(a,b,c,d,x[i+4],6,-145523070);d=md5ii(d,a,b,c,x[i+11],10,-1120210379);c=md5ii(c,d,a,b,x[i+2],15,718787259);b=md5ii(b,c,d,a,x[i+9],21,-343485551);a=safeAdd(a,olda);b=safeAdd(b,oldb);c=safeAdd(c,oldc);d=safeAdd(d,oldd)}return[a,b,c,d]}
  function rstr2hex(inp){var hexx='0123456789abcdef',output='';for(var i=0;i<inp.length;i++){output+=hexx.charAt((inp.charCodeAt(i)>>>4)&0x0F)+hexx.charAt(inp.charCodeAt(i)&0x0F)}return output}
  var binaryStr = str2rstr_utf8(str);
  return rstr2hex(binl2rstr(binlMD5(rstr2binl(binaryStr), binaryStr.length * 8)));
}

// ‚îÄ‚îÄ‚îÄ SECTION 1: HASH EXPLORER ‚îÄ‚îÄ‚îÄ
async function computeHashes() {
  const input = document.getElementById('hash-input').value || '';
  const out = document.getElementById('hash-output');
  out.innerHTML = '<div style="color:var(--muted);font-family:Share Tech Mono,monospace;font-size:0.78rem;">Computing...</div>';

  const results = [
    { label: 'MD5 (128b)', value: md5(input) },
    { label: 'SHA-1 (160b)', value: await sha1(input) },
    { label: 'SHA-256 (256b)', value: await sha256(input) },
    { label: 'SHA-512 (512b)', value: await sha512(input) },
  ];

  out.innerHTML = results.map(r => `
    <div class="hash-item">
      <div class="hash-label">${r.label}</div>
      <div class="hash-value">${r.value}</div>
    </div>
  `).join('');
}

async function avalanche() {
  const a = document.getElementById('aval-a').value;
  const b = document.getElementById('aval-b').value;
  const ha = await sha256(a);
  const hb = await sha256(b);

  // Count differing bits (approximate from hex)
  let diffBits = 0;
  for(let i = 0; i < Math.min(ha.length, hb.length); i++) {
    const diff = parseInt(ha[i],16) ^ parseInt(hb[i],16);
    diffBits += diff.toString(2).split('1').length - 1;
  }
  const pct = ((diffBits / 256) * 100).toFixed(1);

  const out = document.getElementById('aval-output');
  out.innerHTML = `
<span class="info">Input A:</span> "${a}"
<span class="ok">SHA-256:</span> ${ha}

<span class="info">Input B:</span> "${b}"
<span class="ok">SHA-256:</span> ${hb}

<span class="warn">Bits changed: ~${diffBits}/256 (${pct}%)</span>
<span class="dim">Ideal avalanche effect: ~50% bits differ ‚Äî this is ${pct >= 40 && pct <= 60 ? '‚úì good' : '~ close'}</span>
  `.trim();
}

// ‚îÄ‚îÄ‚îÄ SECTION 2: SALTING ‚îÄ‚îÄ‚îÄ
function randomHex(bytes) {
  const arr = new Uint8Array(bytes);
  crypto.getRandomValues(arr);
  return Array.from(arr).map(b => b.toString(16).padStart(2,'0')).join('');
}

async function demoSalting() {
  const pw = document.getElementById('salt-pw').value || 'password';
  const users = ['alice', 'bob', 'carol', 'dave'];
  const out = document.getElementById('salt-output');
  const noSalt = document.getElementById('no-salt-term');
  const withSalt = document.getElementById('with-salt-term');

  const unsaltedHash = await sha256(pw);
  noSalt.innerHTML = users.map(u =>
    `<span class="info">${u.padEnd(6)}</span> ‚Üí <span class="fail">${unsaltedHash}</span>`
  ).join('\n');
  noSalt.innerHTML += `\n<span class="warn">\n‚ö† All 4 users have IDENTICAL hashes!</span>`;

  const salted = [];
  for(const u of users) {
    const salt = randomHex(16);
    const h = await sha256(salt + pw);
    salted.push({user:u, salt, hash:h});
  }

  withSalt.innerHTML = salted.map(s =>
    `<span class="info">${s.user.padEnd(6)}</span> [salt:<span class="warn">${s.salt.slice(0,8)}...</span>] ‚Üí <span class="ok">${s.hash.slice(0,32)}...</span>`
  ).join('\n');
  withSalt.innerHTML += `\n<span class="ok">\n‚úì All hashes are UNIQUE even with same password!</span>`;

  out.innerHTML = `
    <div style="color:var(--muted);font-size:0.78rem;font-family:'Share Tech Mono',monospace;margin-bottom:12px;">Full salted hash records:</div>
    ${salted.map(s => `
      <div class="salt-row">
        <div class="user">${s.user}</div>
        <div class="salt">${s.salt.slice(0,16)}</div>
        <div class="hash">${s.hash}</div>
      </div>
    `).join('')}
  `;
}

// ‚îÄ‚îÄ‚îÄ SECTION 3: STRENGTH ‚îÄ‚îÄ‚îÄ
const CRACK_TABLE_DATA = [
  { pattern: "4-digit PIN", example: "4829", charset: 10, length: 4 },
  { pattern: "6 lowercase", example: "castle", charset: 26, length: 6 },
  { pattern: "8 alphanum", example: "Tr0ub4do", charset: 62, length: 8 },
  { pattern: "10 alphanum+sym", example: "P@ss!2024a", charset: 94, length: 10 },
  { pattern: "12 full ASCII", example: "Correct!Horse9", charset: 95, length: 12 },
  { pattern: "16+ passphrase", example: "battery-staple-X9!", charset: 95, length: 18 },
];

function fmtTime(sec) {
  if(sec < 0.001) return '< 1ms';
  if(sec < 1) return `${(sec*1000).toFixed(0)}ms`;
  if(sec < 60) return `${sec.toFixed(1)}s`;
  if(sec < 3600) return `${(sec/60).toFixed(1)} min`;
  if(sec < 86400) return `${(sec/3600).toFixed(1)} hrs`;
  if(sec < 31536000) return `${(sec/86400).toFixed(1)} days`;
  if(sec < 31536000*1e6) return `${(sec/31536000).toFixed(0)} years`;
  return `${(sec/31536000).toExponential(1)} years`;
}

function populateCrackTable() {
  const table = document.getElementById('crack-table');
  const gpuRate = 8_000_000_000;
  const rows = CRACK_TABLE_DATA.map(d => {
    const space = Math.pow(d.charset, d.length);
    const sec = space / (gpuRate * 2);
    const color = sec < 60 ? 'badge-bad' : sec < 86400 ? 'badge-warn' : 'badge-good';
    return `<tr>
      <td>${d.pattern}</td>
      <td><code style="color:var(--amber)">${d.example}</code></td>
      <td>${space.toExponential(2)}</td>
      <td class="${color}">${fmtTime(sec)}</td>
    </tr>`;
  });
  table.innerHTML = `<tr><th>Pattern</th><th>Example</th><th>Search Space</th><th>Est. Crack Time</th></tr>` + rows.join('');
}

function analyzeStrength() {
  const pw = document.getElementById('pw-analyze').value;
  if(!pw) return;

  const checks = [
    { label: '‚â• 8 chars',    pass: pw.length >= 8 },
    { label: '‚â• 12 chars',   pass: pw.length >= 12 },
    { label: '‚â• 16 chars',   pass: pw.length >= 16 },
    { label: 'Lowercase',    pass: /[a-z]/.test(pw) },
    { label: 'Uppercase',    pass: /[A-Z]/.test(pw) },
    { label: 'Digits',       pass: /[0-9]/.test(pw) },
    { label: 'Symbols',      pass: /[^a-zA-Z0-9]/.test(pw) },
    { label: 'Not common',   pass: !['password','123456','qwerty','letmein','iloveyou','dragon'].includes(pw.toLowerCase()) },
  ];

  const weights = [1,1,1,1,1,1,2,2];
  const score = checks.reduce((s,c,i) => s + (c.pass ? weights[i] : 0), 0);
  const maxScore = weights.reduce((a,b) => a+b, 0);
  const pct = score / maxScore;

  const levels = ['Very Weak','Weak','Fair','Good','Strong','Very Strong'];
  const colors = ['#ff3b5c','#ff6b35','#ffaa00','#88dd00','#00cc66','#00ff88'];
  const idx = Math.min(Math.floor(pct * levels.length), levels.length-1);

  document.getElementById('strength-label').textContent = levels[idx];
  document.getElementById('strength-label').style.color = colors[idx];
  document.getElementById('strength-score').textContent = `${score}/${maxScore}`;
  const bar = document.getElementById('strength-bar');
  bar.style.width = (pct*100) + '%';
  bar.style.background = colors[idx];

  document.getElementById('pw-checks').innerHTML = checks.map(c =>
    `<div class="check-item ${c.pass?'pass':'fail'}">${c.pass?'‚úÖ':'‚ùå'} ${c.label}</div>`
  ).join('');

  let charsetSize = 0;
  if(/[a-z]/.test(pw)) charsetSize += 26;
  if(/[A-Z]/.test(pw)) charsetSize += 26;
  if(/[0-9]/.test(pw)) charsetSize += 10;
  if(/[^a-zA-Z0-9]/.test(pw)) charsetSize += 32;
  const combos = Math.pow(charsetSize, pw.length);
  const gpuSec = combos / (8_000_000_000 * 2);
  const bcryptSec = combos / (10000 * 2); // bcrypt ~10k/sec

  document.getElementById('pw-stats').innerHTML = `
<span class="info">Password   :</span> "${pw}"
<span class="info">Length     :</span> ${pw.length} characters
<span class="info">Charset    :</span> ~${charsetSize} symbols ‚Üí ${combos.toExponential(2)} combinations

<span class="warn">GPU (MD5)  :</span> ${fmtTime(gpuSec)} to crack
<span class="ok">bcrypt c=12:</span> ${fmtTime(bcryptSec)} to crack (10,000√ó harder)

<span class="dim">Tip: Length matters more than complexity!</span>
  `.trim();
}

// ‚îÄ‚îÄ‚îÄ SECTION 4: CRACKER SIM ‚îÄ‚îÄ‚îÄ
const WORDLIST = [
  "password","123456","password123","admin","letmein","welcome","monkey",
  "dragon","master","sunshine","shadow","superman","michael","jessica",
  "football","qwerty","iloveyou","trustno1","princess","baseball",
  "abc123","batman","hunter2","passw0rd","p@ssword","P@ssword"
];

let crackTimer = null;
let crackRunning = false;

function stopCrack() {
  crackRunning = false;
  clearInterval(crackTimer);
  document.getElementById('crack-btn').style.display = '';
  document.getElementById('stop-btn').style.display = 'none';
  document.getElementById('stat-status').textContent = 'STOPPED';
  document.getElementById('stat-status').style.color = 'var(--amber)';
}

async function startCrack() {
  const target = document.getElementById('crack-target').value;
  const targetHash = md5(target);
  const log = document.getElementById('crack-log');

  document.getElementById('crack-btn').style.display = 'none';
  document.getElementById('stop-btn').style.display = '';
  document.getElementById('stat-status').textContent = 'RUNNING';
  document.getElementById('stat-status').style.color = 'var(--amber)';
  crackRunning = true;

  log.innerHTML = `<span class="info">[*] Starting dictionary attack...</span>\n`;
  log.innerHTML += `<span class="dim">[*] Target hash: ${targetHash}</span>\n`;
  log.innerHTML += `<span class="dim">[*] Wordlist: ${WORDLIST.length} entries</span>\n\n`;

  const start = Date.now();
  let i = 0;

  const tick = () => {
    if(!crackRunning) return;
    const guess = WORDLIST[i];
    const guessHash = md5(guess);
    const elapsed = (Date.now() - start) / 1000;
    const rate = Math.floor((i+1) / elapsed);

    document.getElementById('stat-attempts').textContent = i+1;
    document.getElementById('stat-time').textContent = elapsed.toFixed(3);
    document.getElementById('stat-rate').textContent = rate || 0;
    document.getElementById('crack-progress').style.width = `${((i+1)/WORDLIST.length*100)}%`;

    log.innerHTML += `<span class="dim">  trying: "${guess.padEnd(16)}" ‚Üí ${guessHash}</span>\n`;
    log.scrollTop = log.scrollHeight;

    if(guessHash === targetHash) {
      crackRunning = false;
      clearInterval(crackTimer);
      log.innerHTML += `\n<span class="ok">‚úì CRACKED: "${guess}" (${i+1} attempts in ${elapsed.toFixed(3)}s)</span>\n`;
      document.getElementById('stat-status').textContent = 'CRACKED';
      document.getElementById('stat-status').style.color = 'var(--red)';
      document.getElementById('crack-btn').style.display = '';
      document.getElementById('stop-btn').style.display = 'none';
      return;
    }

    i++;
    if(i >= WORDLIST.length) {
      crackRunning = false;
      clearInterval(crackTimer);
      log.innerHTML += `\n<span class="fail">‚úó Not found in wordlist after ${WORDLIST.length} attempts</span>\n`;
      document.getElementById('stat-status').textContent = 'NOT FOUND';
      document.getElementById('crack-btn').style.display = '';
      document.getElementById('stop-btn').style.display = 'none';
    }
  };

  crackTimer = setInterval(tick, 80);
}

// ‚îÄ‚îÄ‚îÄ HYBRID ATTACK ‚îÄ‚îÄ‚îÄ
function generateMutations(word) {
  const leet = w => w.replace(/a/gi,'4').replace(/e/gi,'3').replace(/i/gi,'1').replace(/o/gi,'0').replace(/s/gi,'$').replace(/t/gi,'7');
  const cap = w => w.charAt(0).toUpperCase() + w.slice(1);
  return [
    word, cap(word), word.toUpperCase(),
    word+'1', word+'123', word+'!', word+'@', word+'2024', word+'2025',
    '!'+word, leet(word), cap(leet(word)),
    cap(word)+'1', cap(word)+'!', cap(word)+'123', cap(word)+'@1',
    word+'1!', cap(word)+'1!'
  ];
}

function runHybrid() {
  const target = document.getElementById('hybrid-target').value;
  const targetHash = md5(target);
  const log = document.getElementById('hybrid-log');
  const baseWords = ['password','dragon','sunshine','letmein','welcome','monkey','shadow','master'];

  log.innerHTML = `<span class="info">[*] Hybrid attack on MD5("${target}")</span>\n`;
  log.innerHTML += `<span class="dim">[*] Hash: ${targetHash}</span>\n\n`;

  let attempts = 0, found = false;
  const start = Date.now();

  for(const word of baseWords) {
    const mutations = generateMutations(word);
    for(const m of mutations) {
      attempts++;
      if(md5(m) === targetHash) {
        const t = ((Date.now()-start)/1000).toFixed(3);
        log.innerHTML += `<span class="dim">  [${attempts}] "${m}" ‚Üí ${md5(m)}</span>\n`;
        log.innerHTML += `\n<span class="ok">‚úì CRACKED: "${m}" in ${attempts} attempts (${t}s)</span>\n`;
        found = true;
        break;
      }
      if(attempts <= 5 || attempts % 10 === 0) {
        log.innerHTML += `<span class="dim">  [${attempts}] "${m}"</span>\n`;
      }
    }
    if(found) break;
  }

  if(!found) {
    const t = ((Date.now()-start)/1000).toFixed(3);
    log.innerHTML += `\n<span class="fail">‚úó Not cracked with this wordlist+rules (${attempts} attempts, ${t}s)</span>\n`;
    log.innerHTML += `<span class="warn">  Try a larger wordlist or more rules</span>\n`;
  }
  log.scrollTop = log.scrollHeight;
}

// ‚îÄ‚îÄ‚îÄ SECTION 5: RAINBOW TABLE ‚îÄ‚îÄ‚îÄ
const UNSALTED_DB = [
  { user:'alice',   pw:'password' },
  { user:'bob',     pw:'dragon'   },
  { user:'carol',   pw:'iloveyou' },
  { user:'dave',    pw:'sunshine' },
  { user:'eve',     pw:'7x!kM9@z' }, // complex, not in table
];
const RAINBOW_TABLE = {};
['password','123456','qwerty','iloveyou','letmein','dragon','master','sunshine','monkey','shadow'].forEach(p => {
  RAINBOW_TABLE[md5(p)] = p;
});

async function runRainbowAttack() {
  const dbDiv = document.getElementById('rainbow-db');
  const log = document.getElementById('rainbow-log');

  dbDiv.innerHTML = `<div style="font-size:0.72rem;font-family:'Share Tech Mono',monospace;color:var(--muted);margin-bottom:8px;">UNSALTED DATABASE</div>` +
    UNSALTED_DB.map(u => `
      <div class="db-row" id="row-${u.user}">
        <span class="user">${u.user}</span>
        <span class="hash">${md5(u.pw)}</span>
        <span class="result" id="res-${u.user}">‚Äî</span>
      </div>
    `).join('');

  log.innerHTML = `<span class="info">[*] Rainbow table attack (unsalted MD5)</span>\n`;
  log.innerHTML += `<span class="dim">[*] Pre-computed table: ${Object.keys(RAINBOW_TABLE).length} entries</span>\n\n`;

  let cracked = 0;
  for(const u of UNSALTED_DB) {
    await new Promise(r => setTimeout(r, 400));
    const h = md5(u.pw);
    const found = RAINBOW_TABLE[h];
    const row = document.getElementById('row-'+u.user);
    const res = document.getElementById('res-'+u.user);
    if(found) {
      cracked++;
      row.classList.add('cracked');
      res.textContent = `‚úì "${found}"`;
      res.style.color = 'var(--red)';
      log.innerHTML += `<span class="fail">‚úì ${u.user}: "${found}"</span>\n`;
    } else {
      row.classList.add('safe');
      res.textContent = `‚úó not found`;
      res.style.color = 'var(--green)';
      log.innerHTML += `<span class="ok">‚úó ${u.user}: complex hash ‚Äî NOT in table</span>\n`;
    }
    log.scrollTop = log.scrollHeight;
  }
  log.innerHTML += `\n<span class="warn">Result: ${cracked}/${UNSALTED_DB.length} accounts cracked INSTANTLY!</span>\n`;
}

async function runSaltedAttack() {
  const dbDiv = document.getElementById('rainbow-db');
  const log = document.getElementById('rainbow-log');

  const salted = await Promise.all(UNSALTED_DB.map(async u => {
    const salt = randomHex(8);
    const h = await sha256(salt + u.pw);
    return { user:u.user, salt, hash:h };
  }));

  dbDiv.innerHTML = `<div style="font-size:0.72rem;font-family:'Share Tech Mono',monospace;color:var(--muted);margin-bottom:8px;">SALTED DATABASE (SHA-256)</div>` +
    salted.map(u => `
      <div class="db-row" id="rows-${u.user}">
        <span class="user">${u.user}</span>
        <span class="hash">[salt:${u.salt}] ${u.hash.slice(0,32)}...</span>
        <span class="result" id="ress-${u.user}">‚Äî</span>
      </div>
    `).join('');

  log.innerHTML = `<span class="info">[*] Rainbow table attack (SALTED SHA-256)</span>\n\n`;

  for(const u of salted) {
    await new Promise(r => setTimeout(r, 400));
    document.getElementById('rows-'+u.user).classList.add('safe');
    const res = document.getElementById('ress-'+u.user);
    res.textContent = '‚úì SAFE';
    res.style.color = 'var(--green)';
    log.innerHTML += `<span class="ok">‚úì ${u.user}: Salt makes rainbow table useless</span>\n`;
    log.scrollTop = log.scrollHeight;
  }
  log.innerHTML += `\n<span class="ok">Result: 0/${salted.length} cracked ‚Äî salting defeats rainbow tables!</span>\n`;
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
window.addEventListener('DOMContentLoaded', () => {
  computeHashes();
  populateCrackTable();
  analyzeStrength();
});
</script>
</body>
</html>
